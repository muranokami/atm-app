# 簡易ATM Webアプリ

## 概要
Spring Bootを用いた簡易ATMシステムです。  
ユーザーの登録・認証機能を備え、入出金や振込、残高照会、取引履歴の確認などの機能をWeb上で利用できます。

---

## 主な機能
- ユーザー登録 / ログイン（Spring Security使用）
- 入金 / 出金
- 残高照会
- 振込機能（他ユーザーへの送金）
- 取引履歴の表示
- パスワード変更
- 利用制限 / アカウントロック機能 ※今後実装予定

---

## ログイン画面

ログイン画面では、登録済みのユーザー名とパスワードを入力してログインできます。
---

<img width="821" height="329" alt="Image" src="https://github.com/user-attachments/assets/6c986b14-819e-450f-ab27-3dfafdea60da" />


## 新規登録画面

ログイン画面から遷移して、新規ユーザー登録ができます。

以下の項目を入力すると、ユーザー登録が完了します：

- ユーザー名（必須）
- メールアドレス（必須）
- パスワードパスワード（8文字以上で、英字と数字の両方を含む必要があります）
- 暗証番号（4桁の数字）
- 初期残高（100円以上500000円以下）

### 🔒 入力制限とバリデーション

- パスワードは8文字以上で、英字と数字の両方を含む必要があります
- 暗証番号は4桁の半角数字のみ有効です。
- 初期残高には100円以上500000円以下の数字を入力してください。

### 🚀 登録後の流れ

登録が完了すると、**自動的にログイン状態**となり、ATMのホーム画面に遷移します。

---
<img width="786" height="694" alt="Image" src="https://github.com/user-attachments/assets/4b5d6b51-3bbb-4237-a36f-895f6d3b0579" />

## ホーム画面

ログイン後に表示されるメイン画面です。

登録済みユーザーがATMの各種機能を利用するための起点となります。

### 表示される情報
- ようこそメッセージ（ログイン中のユーザー名）
- 残高

### 利用できる機能
ホーム画面から以下の機能へ遷移できます：

- 💰 **入金**：指定した金額を残高に追加します。
- 🏧 **出金**：指定した金額を残高から引き出します。
- 💸 **振込**：他のユーザーへ指定した金額を送金できます。送金元と送金先の両方に取引履歴が記録されます。
- 📊 **残高照会**：現在の残高を確認できます。
- 📜 **取引履歴**：これまでの入出金、振込（送金・受取）履歴を時系列で表示・検索できます。
- 🔐 **ログアウト**：現在のセッションを終了し、ログイン画面に戻ります。

---
<img width="799" height="656" alt="Image" src="https://github.com/user-attachments/assets/002fc056-a521-421d-9cd3-5c13eb6b0262" />

## 残高照会画面

現在の口座残高を確認できる画面です。

ログイン後、ホーム画面の「残高照会」ボタンを押すことで遷移します。

### 表示内容
- ログイン中のユーザー名（またはID）
- 現在の残高（円単位）

### 特徴
- 表示のみで、データの変更は行われません。
- セキュリティの観点から、必要に応じて残高表示の制限やマスク表示の実装も可能です。※今後実装予定
---
<img width="806" height="384" alt="Image" src="https://github.com/user-attachments/assets/243edde4-d03a-4687-83b9-774c98728caf" />

## 💰 入金画面

ユーザーが自分の口座に金額を入金できる画面です。

### 🔧 入力項目

- 入金金額（必須）  
- 入金したい金額を半角数字で入力します。  
- ※ 100円以上500,000円以下の整数のみ受付けます。

### ✅ バリデーション

- 入金金額は **100円以上500,000円以下の正の整数**である必要があります。
- 無効な入力（空欄、0円、負の数、文字列など）の場合はエラーメッセージが表示され、処理されません。

### 💾 入金後の流れ

- 入金が完了すると、最新の残高が表示されます。
- 同時に、入金履歴が取引履歴に記録されます。

---
<img width="818" height="428" alt="Image" src="https://github.com/user-attachments/assets/46737371-4753-4c03-bac3-2310d1ba01fb" />

## 🏧 出金画面

ユーザーが自分の口座から金額を引き出す画面です。

### 🔧 入力項目

- 出金金額（必須）  
- 100円以上、現在の残高以下の整数のみ受付けます。

### ✅ バリデーション

- 出金金額は100円以上かつ残高以下の正の整数である必要があります。  
- 無効な入力時はエラーメッセージが表示されます。

### 💾 出金後の流れ

- 出金完了後、最新の残高が表示されます。  
- 出金履歴が取引履歴に記録されます。
---
<img width="804" height="403" alt="Image" src="https://github.com/user-attachments/assets/3701135f-81e8-4c85-a51a-fc9de06e715a" />

## 🛠️ 振込画面

本アプリの振込機能では、ログイン中のユーザーが他のユーザーに金額を送金できます。

### 実装概要

- 送金者の残高を減額し、受取者の残高を加算します。
- 送金者には「振込（transfer）」、受取者には「受取（receive）」という2件の取引履歴が記録されます。
- 処理は1つのメソッド内で完結し、`@Transactional` により整合性が保証されます。

### 主な処理の流れ

1. ユーザー名で送金元・受取先を検索
2. 送金元の残高が不足していないか確認
3. 両者の残高を更新
4. `Transaction` エンティティをそれぞれ作成・保存（送金と受取）
5. 処理全体をトランザクションで囲む

### 取引履歴への反映

| ユーザー種別 | 取引タイプ | 金額 | 相手ユーザー名 |
|--------------|------------|------|----------------|
| 送金者       | `transfer` | -1000 | `tanaka`       |
| 受取者       | `receive`  | +1000 | `yamada`       |

検索画面では、取引種別や相手ユーザー名で絞り込みが可能です。
---

<img width="816" height="432" alt="Image" src="https://github.com/user-attachments/assets/11140c71-3aa6-412f-a6f2-0270bf6fc462" />

## 📜 取引履歴画面

過去に行った入出金および振込の履歴を一覧で確認できる画面です。

### 🔍 表示内容
- **結果は取引日時の降順（新しい順）で返されます。
- **取引日時**：各取引の実行日時  
- **取引種別**：`入金`・`出金`・`振込（送金）`・`振込（受取）`  
- **金額**：取引によって増減した金額  
- **取引後残高**：該当取引後の残高  
- **取引相手**：振込の場合、送金先または受取元のユーザー名

### 💡 特徴

- 振込は、送金者・受取者の双方に別々の履歴として記録されます  
  - 送金者側：`振込（送金）` としてマイナス表示  
  - 受取者側：`振込（受取）` としてプラス表示  
- 日付や取引種別、取引相手での **フィルタリング機能** を搭載

---
<img width="787" height="693" alt="Image" src="https://github.com/user-attachments/assets/0eb100f0-d3ed-4187-8cb6-cd4f2d2f43b6" />

---
## 使用技術
- バックエンド：Spring Boot, Spring Security, JPA (Hibernate)
- フロントエンド：Thymeleaf, HTML/CSS
- データベース：PostgreSQL
- ビルドツール：Maven
- その他：Lombok, Bootstrap など

---

## 工夫した点
- Spring Securityを利用し、安全な認証機能を実装
- DBのユーザー情報を元に認証処理を構成
- 入出金・振込時に整合性を保つようトランザクション管理
- Thymeleafによる柔軟なUI構成とデータ表示
- パスワードはBCryptで暗号化して安全性を確保
- アカウントロックやログイン試行制限の追加

---

## 今後の改善点
- テストコード（JUnit/Mockito）による自動テストの実装
- フロントエンドのレスポンシブ対応（スマホ画面最適化）
- REST API化してVue.jsやReactと連携
- 例外処理の改善とユーザー向けのエラーメッセージ表示
- 管理者画面の実装
- 振込機能の実装　

---

## デモ用アカウント情報

以下は動作確認やデモ用に用意したアカウントです。

| ユーザー名 | パスワード     |
| ---------- | ------------- |
| test    | test2222   |

> ※このアカウントはテスト・デモ用です。  
> 実際の運用環境ではご自身で新規登録をお願いします。  
> セキュリティ上、本番環境のパスワードは公開しないようご注意ください。
---

## データベースについて

本アプリでは以下の情報をデータベースに保存しています。

- ユーザー登録情報（ユーザーID、登録日時、ログイン情報など）
- 取引履歴（取引日時、取引種別、金額、残高など）

### 個人情報の取り扱いについて

- 本ポートフォリオは学習・デモ目的のため、実際の個人情報は使用していません。  
- 画面キャプチャやサンプルデータにて個人を特定できる情報は伏せる、または架空の情報を使用しています。  
- パスワードは暗号化（BCrypt）して保存し、安全に管理しています。  
- 実運用時には、適切なアクセス制限やセキュリティ対策を行う必要があります。

---

安心してご覧いただけるよう配慮しておりますが、個人情報の取り扱いには十分ご注意ください。

## 実行方法（ローカル開発環境）

```bash
# リポジトリをクローン
git clone https://github.com/muranokami/atm-app.git
cd atm-app

# PostgreSQLを起動し、設定を application.properties に記述
# DB初期化は自動マイグレーションで行われます

# アプリケーションを起動
./mvnw spring-boot:run
